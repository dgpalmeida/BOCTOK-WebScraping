<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"/>
<meta http-equiv="Pragma" content="no-cache"/>
<meta http-equiv="Expires" content="0"/>
<link rel="icon" type="image/x-icon" href="meu_icone.ico"/>
<title>Eventos JFL</title>
<style>
    body {
        background: #111;
        color: #eee;
        font-family: 'Segoe UI', Arial, sans-serif;
        margin: 0;
        padding: 0;
    }
    .container {
        width: 95%;
        max-width: 1400px;
        margin: 30px auto;
        padding: 24px 32px;
        background: #181818;
        border-radius: 16px;
        box-shadow: 0 4px 24px rgba(0, 0, 0, 0.5);
    }
    h2 {
        color: #fff;
        text-align: center;
        margin-bottom: 24px;
        letter-spacing: 1px;
    }
    .top-bar {
        display: flex;
        justify-content: flex-end;
        align-items: center;
        margin-bottom: 18px;
        gap: 10px;
    }
    .btn-cadastrar {
        background: linear-gradient(90deg, #444 60%, #222 100%);
        color: #fff;
        border: none;
        padding: 10px 22px;
        border-radius: 8px;
        font-size: 1em;
        font-weight: 600;
        cursor: pointer;
        box-shadow: 0 2px 8px #0004;
        transition: background 0.2s, transform 0.2s;
        margin-bottom: 0;
    }
    .btn-cadastrar:hover {
        background: linear-gradient(90deg, #666 60%, #333 100%);
        transform: scale(1.04);
    }
    /* Pop-up */
    .popup-bg {
        display: none;
        position: fixed;
        top: 0; left: 0; right: 0; bottom: 0;
        background: #000a;
        z-index: 1000;
        justify-content: center;
        align-items: center;
        animation: fadeIn 0.3s ease;
    }
    @keyframes fadeIn {
        from {
            opacity: 0;
        }
        to {
            opacity: 1;
        }
    }
    .popup {
        background: #222;
        border-radius: 12px;
        box-shadow: 0 4px 24px #000c;
        padding: 32px 28px 24px 28px;
        min-width: 320px;
        width: 480px; /* Largura padrão para pop-ups de formulário */
        max-width: 95%; /* Garante que caiba em telas pequenas */
        color: #eee;
        display: flex;
        flex-direction: column;
        gap: 16px;
        position: relative;
        animation: popupIn 0.2s;
    }
    @keyframes popupIn {
        from { transform: scale(0.9); opacity: 0; }
        to { transform: scale(1); opacity: 1; }
    }
    /* Tamanhos específicos para pop-ups com tabelas ou conteúdo maior */
    #popup-list-bg .popup,
    #popup-edit-centrais-bg .popup {
        width: 90vw;
        max-width: 800px;
    }

    #novo-dado-popup-bg .popup {
        width: 90vw;
        max-width: 650px;
    }

    .popup label {
        font-size: 1em;
        margin-bottom: 4px;
    }
    .popup input {
        padding: 8px 10px;
        border-radius: 6px;
        border: 1px solid #444;
        background: #181818;
        color: #eee;
        font-size: 1em;
        margin-bottom: 10px;
        width: 100%;
        box-sizing: border-box;
    }
    .popup select {
        padding: 8px 10px;
        border-radius: 6px;
        border: 1px solid #444;
        background: #181818;
        color: #eee;
        font-size: 1em;
        margin-bottom: 10px;
        width: 100%;
        box-sizing: border-box;
    }
    .popup .popup-actions {
        display: flex;
        justify-content: flex-end;
        gap: 12px;
        margin-top: 8px;
    }
    .popup button {
        padding: 8px 18px;
        border-radius: 6px;
        border: none;
        font-size: 1em;
        font-weight: 600;
        cursor: pointer;
        transition: background 0.2s;
    }
    .popup .btn-confirm {
        background: #2ecc40;
        color: #fff;
    }
    .popup .btn-confirm:hover {
        background: #27ae38;
    }
    .popup .btn-cancel {
        background: #e74c3c;
        color: #fff;
    }
    .popup .btn-cancel:hover {
        background: #c0392b;
    }
    .popup .popup-error {
        color: #ff5;
        font-size: 0.98em;
        margin-bottom: 0;
        min-height: 18px;
    }
    table.dataframe {
        border-collapse: collapse;
        width: 100%;
        background: #222;
        color: #eee;
        font-size: 1.08em;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 2px 12px #0006;
    }
    table.dataframe th, table.dataframe td {
        border: 1px solid #444;
        padding: 10px 12px;
        text-align: left;
        transition: background 0.2s;
    }
    table.dataframe th {
        background: linear-gradient(90deg, #333 70%, #222 100%);
        font-weight: 600;
        letter-spacing: 0.5px;
        text-shadow: 0 1px 2px #000a;
    }
    table.dataframe tr:nth-child(even) {
        background: #222;
    }
    table.dataframe tr:nth-child(odd) {
        background: #444;
    }
    table.dataframe tr:hover td {
        background: #505050;
        color: #fff;
        box-shadow: 0 2px 8px #0006;
    }
    .table-responsive {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch; /* Melhora a rolagem em iOS */
        border-radius: 12px; /* Garante que a sombra e borda acompanhem a rolagem */
    }
    table.dataframe td {
        vertical-align: middle;
    }
    /* Tabela da pop-up de usuários */
    .usuarios-table {
        border-collapse: collapse;
        width: 100%;
        min-width: 350px;
        background: #222;
        color: #eee;
        font-size: 1em;
        border-radius: 8px;
        overflow: hidden;
        margin-bottom: 10px;
        table-layout: auto;
    }
    .usuarios-table th, .usuarios-table td {
        border: 1px solid #444;
        padding: 10px 12px;
        text-align: center; /* Centraliza o texto */
        vertical-align: middle;
    }
    .usuarios-table th {
        background: linear-gradient(90deg, #333 70%, #222 100%);
        font-weight: 600;
        letter-spacing: 0.5px;
        text-shadow: 0 1px 2px #000a;
    }
    .usuarios-table tr:nth-child(even) {
        background: #222;
    }
    .usuarios-table tr:nth-child(odd) {
        background: #333;
    }
    .usuarios-table tr:hover td {
        background: #505050;
        color: #fff;
        box-shadow: 0 2px 8px #0006;
    }
    .action-buttons {
        display: flex;
        gap: 1px;
        justify-content: center;
    }
    .action-buttons button {
        flex: 1;
        min-width: 80px; /* Evita que os botões fiquem muito pequenos */
    }
    #usuarios-tabela {
        max-height: 400px;
        overflow-y: auto;
        overflow-x: auto;
        width: 100%;
        display: block;
    }
    /* Animação para destacar novas linhas na tabela */
    .highlight-row {
        animation: highlight 1.5s ease-in-out;
    }
    @keyframes highlight {
        0% {
            background-color: #ff0;
        }
        100% {
            background-color: inherit;
        }
    }

    /* Media Queries para Responsividade */
    @media (max-width: 768px) {
        .container {
            width: 100%;
            margin: 0;
            padding: 16px;
            border-radius: 0;
        }
        .top-bar {
            flex-direction: column;
            align-items: stretch;
        }
        .btn-cadastrar {
            width: 100%;
            text-align: center;
        }
        h2 {
            font-size: 1.5em;
        }
    }
</style>
<script>
// --- INÍCIO DA LÓGICA DE RECARREGAMENTO INTELIGENTE ---
// Este script verifica se o conteúdo do arquivo mudou (usando um timestamp)
// e só recarrega a página se houver uma atualização.
function reloadWithTransition() {
    document.body.classList.add('loading');
    setTimeout(() => {
        window.location.reload();
    }, 300);
}

// Verifica mudanças a cada 15 segundos
setInterval(async () => {
    // Não executa a verificação se alguma pop-up estiver aberta
    if (document.querySelector('.popup-bg[style*="display: flex"]')) {
        console.log("Pop-up aberta, atualização pausada.");
        return;
    }
    try {
        const response = await fetch(window.location.href);
        const newHtml = await response.text();
        const parser = new DOMParser();
        const newDoc = parser.parseFromString(newHtml, 'text/html');
        
        const currentTimestamp = document.querySelector('.timestamp')?.textContent;
        const newTimestamp = newDoc.querySelector('.timestamp')?.textContent;
        
        if (currentTimestamp !== newTimestamp) {
            reloadWithTransition();
        }
    } catch (error) {
        console.error('Erro ao verificar atualizações:', error);
    }
}, 15000);
// --- FIM DA LÓGICA DE RECARREGAMENTO INTELIGENTE ---


// Função global para excluir central
function excluirCentral(numero_serie, btn) {
    if (!confirm('Tem certeza que deseja excluir esta central?')) return;
    fetch('excluir_central', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ numero_serie: numero_serie })
    }).then(resp => resp.json()).then(data => {
        if (data.sucesso) {
            if (btn) {
                let tr = btn.closest('tr');
                if (tr) tr.remove();
            }
            carregarEditCentrais();
        } else {
            alert(data.erro || 'Erro ao excluir central.');
        }
    }).catch(() => {
        alert('Erro de comunicação com o backend.');
    });
}

// <-- REMOVIDO: Funções startRefresh e stopRefresh, pois eram redundantes.

window.onload = function() {
    // <-- REMOVIDO: Chamada a startRefresh()
    fetch('usuarios.csv').then(r => r.text()).then(csv => {
        localStorage.setItem('usuarios_csv', csv);
    });
};

function openPopup() {
    document.getElementById('popup-bg').style.display = 'flex';
    document.getElementById('popup-error').innerText = '';
    document.getElementById('numero').value = '';
    document.getElementById('nome').value = '';
    document.getElementById('numero_serie').value = '';
    // <-- REMOVIDO: Chamada a stopRefresh()
}

function closePopup() {
    document.getElementById('popup-bg').style.display = 'none';
    // <-- REMOVIDO: Chamada a startRefresh()
}

function getUsuariosExistentes() {
    let pares = [];
    try {
        let csv = localStorage.getItem('usuarios_csv');
        if (csv) {
            let linhas = csv.split('\n');
            for (let i = 1; i < linhas.length; i++) {
                let partes = linhas[i].split(',');
                if (partes[0] && partes[2]) pares.push(partes[0].trim() + '|' + partes[2].trim());
            }
        }
    } catch(e){}
    return pares;
}
function validarCadastro() {
    let numero = document.getElementById('numero').value.trim();
    let nome = document.getElementById('nome').value.trim();
    let numero_serie = document.getElementById('numero_serie').value.trim();
    let erro = '';
    if (!/^\d{3}$/.test(numero)) {
        erro = 'O número deve ter exatamente 3 dígitos.';
    } else if (!nome) {
        erro = 'Informe o nome do usuário.';
    } else if (!numero_serie) {
        erro = 'Informe o número de série.';
    } else {
        let pares = getUsuariosExistentes();
        if (pares.includes(numero + '|' + numero_serie)) {
            erro = 'Já existe este número com este número de série!';
        }
    }
    document.getElementById('popup-error').innerText = erro;
    return !erro;
}
function confirmarCadastro() {
    if (!validarCadastro()) return;
    let numero = document.getElementById('numero').value.trim();
    let nome = document.getElementById('nome').value.trim();
    let numero_serie = document.getElementById('numero_serie').value.trim();
    fetch('cadastrar_usuario', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ numero: numero, nome: nome, numero_serie: numero_serie })
    }).then(resp => resp.json()).then(data => {
        if (data.sucesso) {
            closePopup();
            alert('Usuário cadastrado com sucesso! Atualize a página para ver na tabela.');
        } else {
            document.getElementById('popup-error').innerText = data.erro || 'Erro ao cadastrar.';
        }
    }).catch(() => {
        document.getElementById('popup-error').innerText = 'Erro de comunicação com o backend.';
    });
}

// --- FUNÇÕES PARA LISTAGEM DE USUÁRIOS ---
function carregarUsuariosTabela() {
    fetch('usuarios.csv').then(r => r.text()).then(csv => {
        let linhas = csv.trim().split('\n');
        if (linhas.length < 2) {
            document.getElementById('usuarios-tabela').innerHTML = '<em>Nenhum usuário cadastrado.</em>';
            return;
        }
        let html = '<table class="usuarios-table"><thead><tr>';
        let headers = linhas[0].split(',');
        for (let h of headers) html += `<th>${h}</th>`;
        html += '<th>Ações</th></tr></thead><tbody>';
        for (let i = 1; i < linhas.length; i++) {
            let cols = linhas[i].split(',');
            let numero = cols[0] ? cols[0] : '';
            let nome = cols[1] ? cols[1] : '';
            let numero_serie = cols[2] ? cols[2] : '';
            html += '<tr>';
            for (let c of cols) html += `<td>${c}</td>`;
            html += `<td>
                <div class="action-buttons">
                    <button class="btn-cancel apagar-btn" data-numero="${numero}" data-numero_serie="${numero_serie}">Apagar</button>
                    <button class="btn-confirm editar-btn" data-numero="${numero}" data-numero_serie="${numero_serie}" data-nome="${nome}">Editar</button>
                </div>
            </td>`;
            html += '</tr>';
        }
        html += '</tbody></table>';
        document.getElementById('usuarios-tabela').innerHTML = html;
    }).catch(() => {
        document.getElementById('usuarios-tabela').innerHTML = '<em>Erro ao carregar usuários.</em>';
    });
}

document.addEventListener('DOMContentLoaded', function() {
    let tabela = document.getElementById('usuarios-tabela');
    if (tabela) {
        tabela.onclick = function(e) {
            if (e.target && e.target.classList.contains('apagar-btn')) {
                let numero = e.target.getAttribute('data-numero');
                let numero_serie = e.target.getAttribute('data-numero_serie');
                apagarUsuario(numero, numero_serie, e.target);
            }
            if (e.target && e.target.classList.contains('editar-btn')) {
                let numero = e.target.getAttribute('data-numero');
                let numero_serie = e.target.getAttribute('data-numero_serie');
                let nomeAtual = e.target.getAttribute('data-nome');
                editarUsuario(numero, numero_serie, nomeAtual, e.target);
            }
            if (e.target && e.target.classList.contains('excluir-central-btn')) {
                let numero_serie = e.target.getAttribute('data-numero_serie');
                excluirCentral(numero_serie, e.target);
            }
        };
    }
    let fecharBtn = document.querySelector('#popup-list-bg .btn-cancel');
    if (fecharBtn) {
        fecharBtn.onclick = function() {
            location.reload();
        };
    }
});

function editarUsuario(numero, numero_serie, nomeAtual, btn) {
    let novoNome = prompt("Editar nome do usuário:", nomeAtual);
    if (novoNome === null) return;
    novoNome = novoNome.trim();
    if (!novoNome) {
        alert("O nome não pode ser vazio.");
        return;
    }
    fetch('editar_usuario', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ numero: numero, numero_serie: numero_serie, nome: novoNome })
    }).then(resp => resp.json()).then(data => {
        if (data.sucesso) {
            let tr = btn.closest('tr');
            if (tr) {
                let tds = tr.querySelectorAll('td');
                if (tds.length >= 2) tds[1].innerText = novoNome;
                btn.setAttribute('data-nome', novoNome);
            }
        } else {
            alert(data.erro || 'Erro ao editar usuário.');
        }
    }).catch(() => {
        alert('Erro de comunicação com o backend.');
    });
}

function openListPopup() {
    document.getElementById('popup-list-bg').style.display = 'flex';
    // <-- REMOVIDO: Chamada a stopRefresh()
    carregarUsuariosTabela();
    setTimeout(() => {
        let tabela = document.getElementById('usuarios-tabela');
        if (tabela) {
            tabela.onclick = function(e) {
                if (e.target && e.target.classList.contains('apagar-btn')) {
                    let numero = e.target.getAttribute('data-numero');
                    let numero_serie = e.target.getAttribute('data-numero_serie');
                    apagarUsuario(numero, numero_serie, e.target);
                }
                if (e.target && e.target.classList.contains('editar-btn')) {
                    let numero = e.target.getAttribute('data-numero');
                    let numero_serie = e.target.getAttribute('data-numero_serie');
                    let nomeAtual = e.target.getAttribute('data-nome');
                    editarUsuario(numero, numero_serie, nomeAtual, e.target);
                }
            };
        }
    }, 100);
}

function apagarUsuario(numero, numero_serie, btn) {
    if (!confirm('Tem certeza que deseja apagar este usuário?')) return;
    fetch('apagar_usuario', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ numero: numero, numero_serie: numero_serie })
    }).then(resp => resp.json()).then(data => {
        if (data.sucesso) {
            let tr = btn.closest('tr');
            if (tr) tr.remove();
        } else {
            alert(data.erro || 'Erro ao apagar usuário.');
        }
    }).catch(() => {
        alert('Erro de comunicação com o backend.');
    });
}

// --- POPUP NOVO DADO ---
function mostrarNovoDadoPopup(dados) {
    const popupBg = document.getElementById('novo-dado-popup-bg');
    const popupDados = document.getElementById('novo-dado-popup-dados');
    
    if (popupBg && popupDados) {
        // <-- REMOVIDO: Chamada a stopRefresh()
        popupBg.style.display = 'flex';
        popupDados.innerText = dados;
    }
}
function fecharNovoDadoPopup() {
    document.getElementById('novo-dado-popup-bg').style.display = 'none';
    // <-- REMOVIDO: Chamada a startRefresh()
}

document.addEventListener('DOMContentLoaded', function() {
    document.body.style.opacity = 0;
    document.body.style.transition = 'opacity 0.5s ease';
    setTimeout(() => {
        document.body.style.opacity = 1;
    }, 100);
});

function destacarNovaLinha(rowElement) {
    rowElement.classList.add('highlight-row');
    setTimeout(() => {
        rowElement.classList.remove('highlight-row');
    }, 1500);
}

/* --- FUNÇÕES PARA EDIÇÃO DE CENTRAIS --- */
function openEditCentraisPopup() {
    document.getElementById('popup-edit-centrais-bg').style.display = 'flex';
    // <-- REMOVIDO: Chamada a stopRefresh()
    carregarEditCentrais();
}
function closeEditCentraisPopup() {
    document.getElementById('popup-edit-centrais-bg').style.display = 'none';
    // <-- REMOVIDO: Chamada a startRefresh()
}
function carregarEditCentrais() {
    fetch('centrais.csv').then(r => r.text()).then(csv => {
        let linhas = csv.trim().split('\n');
        if (linhas.length < 2) {
            document.getElementById('edit-centrais-content').innerHTML = '<em>Nenhuma central cadastrada.</em>';
            return;
        }
        let html = '<table class="usuarios-table"><thead><tr>';
        let headers = linhas[0].split(',');
        for (let h of headers) html += `<th>${h}</th>`;
        html += '<th>Ações</th></tr></thead><tbody>';
        for (let i = 1; i < linhas.length; i++) {
            let cols = linhas[i].split(',');
            let numero_serie = cols[0] ? cols[0] : '';
            let nome = cols[1] ? cols[1] : '';
            html += '<tr>';
            for (let c of cols) html += `<td>${c}</td>`;
            html += `<td>
                <div class="action-buttons">
                    <button class="btn-confirm editar-central-btn" data-numero_serie="${numero_serie}" data-nome="${nome}">Editar</button>
                    <button class="btn-cancel excluir-central-btn" data-numero_serie="${numero_serie}">Excluir</button>
                </div>
            </td>`;
            html += '</tr>';
        }
        html += '</tbody></table>';
        document.getElementById('edit-centrais-content').innerHTML = html;
        let tabela = document.getElementById('edit-centrais-content');
        if (tabela) {
            tabela.onclick = function(e) {
                if (e.target && e.target.classList.contains('editar-central-btn')) {
                    let numero_serie = e.target.getAttribute('data-numero_serie');
                    let nome = e.target.getAttribute('data-nome');
                    abrirEditarCentralPopup(numero_serie, nome);
                }
                if (e.target && e.target.classList.contains('excluir-central-btn')) {
                    let numero_serie = e.target.getAttribute('data-numero_serie');
                    excluirCentral(numero_serie, e.target);
                }
            };
        }
    }).catch(() => {
        document.getElementById('edit-centrais-content').innerHTML = '<em>Erro ao carregar centrais.</em>';
    });
}

document.getElementById('popup-edit-centrais-bg').addEventListener('open', function() {
    carregarEditCentrais();
});

/* --- FIM DAS FUNÇÕES DE EDIÇÃO DE CENTRAIS --- */

var centralEditando = null;

function abrirEditarCentralPopup(numero_serie, nome) {
    centralEditando = numero_serie;
    document.getElementById('editar-numero-serie').value = numero_serie;
    document.getElementById('editar-nome-central').value = nome;
    document.getElementById('popup-editar-central-erro').innerText = '';
    document.getElementById('popup-editar-central-bg').style.display = 'flex';
    // <-- REMOVIDO: Chamada a stopRefresh()
}
function fecharEditarCentralPopup() {
    document.getElementById('popup-editar-central-bg').style.display = 'none';
    // <-- REMOVIDO: Chamada a startRefresh()
}
function confirmarEditarCentral() {
    var numero_serie_novo = document.getElementById('editar-numero-serie').value.trim();
    var nome_novo = document.getElementById('editar-nome-central').value.trim();
    if (!numero_serie_novo || !nome_novo) {
        document.getElementById('popup-editar-central-erro').innerText = 'Preencha todos os campos.';
        return;
    }
    fetch('editar_central', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            numero_serie_antigo: centralEditando,
            numero_serie_novo: numero_serie_novo,
            nome_novo: nome_novo
        })
    }).then(resp => resp.json()).then(data => {
        if (data.sucesso) {
            fecharEditarCentralPopup();
            carregarEditCentrais();
        } else {
            document.getElementById('popup-editar-central-erro').innerText = data.erro || 'Erro ao editar central.';
        }
    }).catch(() => {
        document.getElementById('popup-editar-central-erro').innerText = 'Erro de comunicação com o backend.';
    });
}

// --- POPUP NOVA CENTRAL ---
function abrirNovaCentralPopup() {
    document.getElementById('popup-nova-central-bg').style.display = 'flex';
    document.getElementById('popup-nova-central-erro').innerText = '';
    document.getElementById('nova-central-numero-serie').value = '';
    document.getElementById('nova-central-nome').value = '';
    popupNovaCentralAberta = true;
    // <-- REMOVIDO: Chamada a stopRefresh()
}
function fecharNovaCentralPopup() {
    document.getElementById('popup-nova-central-bg').style.display = 'none';
    popupNovaCentralAberta = false;
    // <-- REMOVIDO: Chamada a startRefresh()
}
function confirmarNovaCentral() {
    var numero_serie = document.getElementById('nova-central-numero-serie').value.trim();
    var nome = document.getElementById('nova-central-nome').value.trim();
    if (!numero_serie || !nome) {
        document.getElementById('popup-nova-central-erro').innerText = 'Preencha todos os campos.';
        return;
    }
    if (!/^\d+$/.test(numero_serie)) {
        document.getElementById('popup-nova-central-erro').innerText = 'O número de série deve conter apenas números.';
        return;
    }
    fetch('adicionar_central', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ numero_serie: numero_serie, nome: nome })
    }).then(resp => resp.json()).then(data => {
        if (data.sucesso) {
            fecharNovaCentralPopup();
            carregarEditCentrais();
        } else {
            document.getElementById('popup-nova-central-erro').innerText = data.erro || 'Erro ao adicionar central.';
        }
    }).catch(() => {
        document.getElementById('popup-nova-central-erro').innerText = 'Erro de comunicação com o backend.';
    });
}

</script>
</head>
<body>
<div class="container">
    <div class="top-bar" style="justify-content: space-between;">
        <button class="btn-cadastrar" onclick="openPopup()">Cadastrar Usuário</button>
        <button class="btn-cadastrar" style="margin-left:10px" onclick="openListPopup()">Listar Usuários</button>
        <button class="btn-cadastrar" style="margin-left:10px" onclick="openEditCentraisPopup()">Editar Centrais</button>
    </div>
    <h2>Eventos JFL</h2>
    <div class="popup-bg" id="popup-bg">
        <div class="popup">
            <label for="numero">Número do usuário (3 dígitos):</label>
            <input type="text" id="numero" maxlength="3" pattern="\d3" autocomplete="off" inputmode="numeric" oninput="this.value=this.value.replace(/[^0-9]/g,'')" />
            <label for="nome">Nome da loja:</label>
            <input type="text" id="nome" maxlength="50" autocomplete="off"/>
            <label for="numero_serie">Localização da Central:</label>
            <select id="numero_serie" autocomplete="off">
                <option value="2785030333">Rack C</option>
<option value="2785033725">Rack E</option>
<option value="2785030982">Rack G</option>
<option value="2785030934">Shaft B</option>
<option value="2785030936">Shaft D</option>
            </select>
            <div class="popup-error" id="popup-error"></div>
            <div class="popup-actions">
                <button class="btn-confirm" onclick="confirmarCadastro()">Confirmar</button>
                <button class="btn-cancel" onclick="closePopup()">Cancelar</button>
            </div>
        </div>
    </div>
    <div class="popup-bg" id="popup-list-bg">
        <div class="popup">
            <h3 style="margin-top:0;">Usuários Cadastrados</h3>
            <div id="usuarios-tabela" style="max-height:400px;overflow-y:auto;overflow-x:auto;width:100%;"></div>
            <div class="popup-actions">
                <button class="btn-cancel" onclick="closeListPopup()">Fechar</button>
            </div>
        </div>
    </div>
    <div class="popup-bg" id="popup-edit-centrais-bg" style="display:none;">
        <div class="popup">
            <h3 style="margin-top:0;">Editar Centrais</h3>
            <button class="btn-confirm" style="margin-bottom:12px;" onclick="abrirNovaCentralPopup()">Adicionar Nova Central</button>
            <div id="edit-centrais-content" style="max-height:400px;overflow-y:auto;overflow-x:auto;width:100%;"></div>
            <div class="popup-actions">
                <button class="btn-cancel" onclick="closeEditCentraisPopup()">Fechar</button>
            </div>
        </div>
    </div>
    <div class="popup-bg" id="novo-dado-popup-bg" style="display:none;">
        <div class="popup">
            <h3 style="margin-top:0;">Novo Evento Detectado</h3>
            <pre id="novo-dado-popup-dados" style="background:#181818;padding:12px 8px;border-radius:6px;color:#fff;font-size:1.08em;"></pre>
            <div class="popup-actions">
                <button class="btn-confirm" onclick="fecharNovoDadoPopup()">OK</button>
            </div>
        </div>
    </div>
    <div class="popup-bg" id="popup-editar-central-bg" style="display:none;">
        <div class="popup">
            <h3 style="margin-top:0;">Editar Central</h3>
            <label for="editar-numero-serie">Número de Série:</label>
            <input type="text" id="editar-numero-serie" maxlength="20" autocomplete="off"/>
            <label for="editar-nome-central">Nome:</label>
            <input type="text" id="editar-nome-central" maxlength="50" autocomplete="off"/>
            <div class="popup-error" id="popup-editar-central-erro"></div>
            <div class="popup-actions">
                <button class="btn-confirm" onclick="confirmarEditarCentral()">Salvar</button>
                <button class="btn-cancel" onclick="fecharEditarCentralPopup()">Cancelar</button>
            </div>
        </div>
    </div>
    <div class="popup-bg" id="popup-nova-central-bg" style="display:none;">
        <div class="popup">
            <h3 style="margin-top:0;">Adicionar Nova Central</h3>
            <label for="nova-central-numero-serie">Número de Série:</label>
            <input type="text" id="nova-central-numero-serie" maxlength="20" autocomplete="off"
                   oninput="this.value=this.value.replace(/[^0-9]/g,'')" />
            <label for="nova-central-nome">Nome:</label>
            <input type="text" id="nova-central-nome" maxlength="50" autocomplete="off"/>
            <div class="popup-error" id="popup-nova-central-erro"></div>
            <div class="popup-actions">
                <button class="btn-confirm" onclick="confirmarNovaCentral()">Adicionar</button>
                <button class="btn-cancel" onclick="fecharNovaCentralPopup()">Cancelar</button>
            </div>
        </div>
    </div>
    <div class="table-responsive">
        <div class="timestamp" style="display:none;">1753706044.383762</div><table border="1" class="dataframe table table-striped">
<thead>
<tr style="text-align: right;">
<th>Conta</th>
<th>Evento</th>
<th>Descrição</th>
<th>Nº Partição/Pgm</th>
<th>Nº Zona/Usuário</th>
<th>Nome Zona/Usuário</th>
<th>Data e hora</th>
<th>Número de série</th>
</tr>
</thead>
<tbody>
<tr>
<td>0000</td>
<td>3253</td>
<td>Reset do software</td>
<td>00</td>
<td>000</td>
<td>---</td>
<td>28/07/25 08:09:35</td>
<td>---</td>
</tr>
<tr>
<td>0000</td>
<td>3253</td>
<td>Reset do software</td>
<td>00</td>
<td>000</td>
<td>---</td>
<td>25/07/25 13:27:44</td>
<td>---</td>
</tr>
<tr>
<td>0000</td>
<td>3253</td>
<td>Reset do software</td>
<td>00</td>
<td>000</td>
<td>---</td>
<td>22/07/25 07:37:59</td>
<td>---</td>
</tr>
<tr>
<td>0000</td>
<td>3253</td>
<td>Reset do software</td>
<td>00</td>
<td>000</td>
<td>---</td>
<td>21/07/25 07:26:39</td>
<td>---</td>
</tr>
<tr>
<td>0000</td>
<td>3253</td>
<td>Reset do software</td>
<td>00</td>
<td>000</td>
<td>---</td>
<td>18/07/25 07:41:18</td>
<td>---</td>
</tr>
<tr>
<td>0000</td>
<td>3253</td>
<td>Reset do software</td>
<td>00</td>
<td>000</td>
<td>---</td>
<td>17/07/25 07:20:45</td>
<td>---</td>
</tr>
<tr>
<td>0000</td>
<td>3253</td>
<td>Reset do software</td>
<td>00</td>
<td>000</td>
<td>---</td>
<td>10/07/25 09:59:28</td>
<td>---</td>
</tr>
<tr>
<td>0000</td>
<td>3253</td>
<td>Reset do software</td>
<td>00</td>
<td>000</td>
<td>---</td>
<td>08/07/25 11:28:58</td>
<td>---</td>
</tr>
<tr>
<td>0000</td>
<td>3253</td>
<td>Reset do software</td>
<td>00</td>
<td>000</td>
<td>---</td>
<td>30/06/25 07:40:04</td>
<td>---</td>
</tr>
</tbody>
</table>
    </div>
</div>

</body>
</html>